<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.greensuresun.dao.ExcelDao">
    <resultMap id="resultMap" type="com.greensuresun.entity.SuccessKilled">
        <result column="seckill_id" jdbcType="VARCHAR" property="seckillId" />
        <result column="user_phone" jdbcType="VARCHAR" property="userPhone" />
        <result column="state" jdbcType="VARCHAR" property="state" />
        <result column="create_time" jdbcType="VARCHAR" property="createTime" />
    </resultMap>


    <insert id="writeDataFromExcel">
        <!--主键冲突的时候，忽视报错, state无效:0-->
        INSERT ignore INTO success_killed(seckill_id, user_phone, state)
        VALUES (#{seckillId}, #{userPhone}, 0)
    </insert>

    <insert id="writeDatasFromExcel" parameterType="java.util.List">
        <selectKey resultType ="java.lang.Integer" keyProperty= "id" order= "AFTER">
            SELECT LAST_INSERT_ID()
        </selectKey>
        INSERT ignore INTO success_killed(user_phone, state)
        VALUES
        <!--<foreach collection="list" item="successKilled" index="i" separator=",">-->
        <foreach item="item" collection="list" separator="," open="(" close=")" index="">
            (
              #{seckillId},
              #{userPhone},
              0
            )
        </foreach>
    </insert>

</mapper>